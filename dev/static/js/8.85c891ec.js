(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{DM7I:function(e,t,r){"use strict";var a=r("HamV");r.n(a).a},HamV:function(e,t,r){},VTYm:function(e,t,r){"use strict";r.r(t);var a=r("TsPW"),n={name:"edit-role-manage",data:function(){return{saveLoading:!1,roleId:"",editForm:{name:"",code:"",checkedMenu:[]},menuList:null,defaultProps:{children:"children",label:"name"},rules:{code:[{required:!0,message:"请输入角色编码",trigger:"blur"},{min:1,max:15,message:"长度在 1 到 15 个字",trigger:"blur"}],name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:1,max:15,message:"长度在 1 到 15 个字",trigger:"blur"}]},validateMenu:!1}},methods:{getAjaxRoleInfo:function(){var e=this,t=this;Object(a.yc)({id:this.roleId}).then(function(r){var a=r.data;a?(t.editForm.name=a.name,t.editForm.code=a.code,t.editForm.checkedMenu=a.menuIdList):e.$message({message:"请求异常",type:"error"})})},getAjaxAllMenu:function(){var e=this,t=this;Object(a.a)().then(function(r){var a=r.data;a&&a.length>0?t.menuList=a:e.$message({message:"请求异常",type:"error"})})},goBack:function(){this.$router.push({path:"/role"})},submitForm:function(e){var t=this,r=this;this.$refs[e].validate(function(e){if(!e)return!1;if(""==t.$refs.tree.getCheckedKeys())return t.validateMenu=!0,!1;t.validateMenu=!1,r.saveLoading=!0;var n={code:r.editForm.code,name:r.editForm.name,id:r.roleId,menuIdList:r.editForm.checkedMenu};Object(a.fd)(n).then(function(e){t.$message({type:"success",message:"操作成功!",duration:300,onClose:function(){r.goBack(),r.saveLoading=!1}})})})},getCheckedKeys:function(){if(this.editForm.checkedMenu=this.$refs.tree.getCheckedKeys(),""==this.$refs.tree.getCheckedKeys())return this.validateMenu=!0,!1;this.validateMenu=!1}},beforeMount:function(){var e=sessionStorage.getItem("roleId");this.roleId=e,e&&this.getAjaxRoleInfo(),this.getAjaxAllMenu()}},o=(r("DM7I"),r("KHd+")),i=Object(o.a)(n,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("权限管理")]),e._v(" "),r("el-breadcrumb-item",{attrs:{to:{path:"/role"}}},[e._v("角色管理")]),e._v(" "),r("el-breadcrumb-item",[e._v(e._s(""==e.roleId?"添加角色":"编辑角色"))])],1),e._v(" "),r("div",{staticClass:"contentBody"},[r("el-form",{ref:"editForm",staticClass:"demo-ruleForm",attrs:{model:e.editForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入",maxlength:15},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"角色编码",prop:"code"}},[r("el-input",{attrs:{placeholder:"请输入",maxlength:15},model:{value:e.editForm.code,callback:function(t){e.$set(e.editForm,"code",t)},expression:"editForm.code"}})],1),e._v(" "),r("el-form-item",[r("div",{attrs:{slot:"label"},slot:"label"},[r("span",{staticClass:"red-span"},[e._v("*")]),e._v("权限分配")]),e._v(" "),[r("el-tree",{ref:"tree",attrs:{"check-strictly":!0,"default-expand-all":!0,data:e.menuList,"show-checkbox":"","node-key":"id","default-checked-keys":e.editForm.checkedMenu,props:e.defaultProps},on:{"check-change":e.getCheckedKeys},model:{value:e.editForm.checkedMenu,callback:function(t){e.$set(e.editForm,"checkedMenu",t)},expression:"editForm.checkedMenu"}})],e._v(" "),e.validateMenu?r("div",{staticClass:"el-form-item__error"},[e._v("\n                    请选择权限\n                ")]):e._e()],2),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:function(t){return e.submitForm("editForm")}}},[e._v("提交")]),e._v(" "),r("el-button",{on:{click:function(t){return e.goBack()}}},[e._v("返回")])],1)],1)],1)],1)},[],!1,null,"0e9adea4",null);i.options.__file="editRole.vue";t.default=i.exports}}]);