(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{"0sPz":function(t,e,a){},"5Bov":function(t,e,a){"use strict";a.r(e);var i=a("TsPW"),o={name:"edit-out-stock-order",data:function(){return{tableData:null,typeBool:!1,logisticsInfo:!1,formLabelWidth:"80px",dialogFormVisible:!1,dialogTitle:"新增报损单明细",dialogForm:{standard:"",number:"",price:"",id:"",name:"",serialNo:"",productInfoId:"",type:"1",remark:""},id:"",saveLoading:!1,editForm:{name:"",dateTime:"",totalNumber:"",totalPrice:"",remark:"",logisticsNo:"",logisticsId:"",customerId:"",company:"",type:"1"},rules:{name:[{required:!0,message:"请输入报损单名称",trigger:"blur"}],dateTime:[{required:!0,message:"请选择报损单日期",trigger:"blur"}]},headers:{sessionId:sessionStorage.getItem("sessionId")},LogisticsList:[],customerList:[],groupList:[],param:{pageSize:-1},param2:{pid:""},param3:{pageSize:-1,status:1},param4:{content:"",pageSize:-1},productList:[],isShow:!1,contentData:[]}},methods:{getdatatime:function(){var t=new Date,e=t.getFullYear(),a=t.getMonth()+1,i=a>9?a:"0"+a,o=t.getDate(),r=o>9?o:"0"+o;this.editForm.dateTime=e+"-"+i+"-"+r},changeProduct:function(t){var e;e=this.productList.find(function(e){return e.id===t}),this.dialogForm.standard=e.standard,this.dialogForm.name=e.name,this.dialogForm.serialNo=e.serialNo},changeGroup:function(t){var e;e=this.groupList.find(function(e){return e.id===t}),this.dialogForm.standard=e.standard,this.dialogForm.name=e.name,this.dialogForm.serialNo=e.serialNo},handleClickDetail:function(t,e,a){var o=this;"delete"==a?o.$confirm("真的删除该行数据么, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={id:e.id};Object(i.z)(t).then(function(t){200==t.status?o.$message({type:"success",message:"删除成功!",duration:300,onClose:function(){o.getAjaxList(1)}}):o.$message({type:"error",message:t.msg})})}).catch(function(){o.$message({type:"info",message:"已取消删除"})}):"add"==a?o.addOrg("add",e):"edit"==a&&o.addOrg("edit",e)},addOrg:function(t,e){this.dialogFormVisible=!0,"add"==t?(this.dialogForm.standard="",this.dialogForm.number="",this.dialogForm.id="",this.dialogForm.price=0,this.dialogForm.productInfoId="",this.dialogForm.remark=""):(this.dialogForm.standard=e.standard,this.dialogForm.id=e.id,this.dialogForm.number=e.number,this.dialogForm.price=e.price,this.dialogForm.productInfoId=e.productInfoId,this.dialogForm.remark=e.remark)},dialogFormAdd:function(t){var e,a=this;e={id:this.dialogForm.id,standard:this.dialogForm.standard,number:this.dialogForm.number,price:this.dialogForm.price,name:this.dialogForm.name,serialNo:this.dialogForm.serialNo,type:this.dialogForm.type,productInfoId:this.dialogForm.productInfoId,remark:this.dialogForm.remark,wasteOrderId:a.id},this.$refs[t].validate(function(t){if(!t)return!1;a.saveLoading=!0,Object(i.Jc)(e).then(function(t){200==t.status?a.$message({type:"success",message:"操作成功!",duration:300,onClose:function(){a.saveLoading=!1,a.dialogFormVisible=!1,a.getAjaxList(1)}}):(a.saveLoading=!1,a.$message({type:"error",message:t.msg}))})})},getAjaxList:function(t){var e=this,a=this;Object(i.xb)(a.param2).then(function(e){a.tableData=[];var i=e.data;if(i&&i.length>0){a.tableData=i;for(var o=0,r=0,l=0;l<a.tableData.length;l++)o+=a.tableData[l].price*a.tableData[l].number,r+=a.tableData[l].number;a.editForm.totalPrice=o,a.editForm.totalNumber=r,1==t&&a.submitForm("editForm")}else a.tableData=[]}),Object(i.Eb)(a.param2).then(function(t){console.log(t),0!=t.data.length&&(e.isShow=!0,e.contentData=t.data)})},requestClientInfo:function(){var t=this,e=this;Object(i.eb)({id:this.id}).then(function(a){if(t.logisticsInfo=!0,200==a.status){var i=a.data;i&&(e.editForm.name=i.name,e.editForm.dateTime=i.dateTime,e.editForm.totalNumber=i.totalNumber,e.editForm.totalPrice=i.totalPrice,e.editForm.remark=i.remark,e.editForm.logisticsId=i.logisticsId,e.editForm.logisticsNo=i.logisticsNo,e.editForm.type=i.type+"",e.editForm.customerId=i.customerId)}else t.$message({message:"请求异常",type:"error"})})},goBack:function(){this.$router.push({path:"/destroy"})},submitForm:function(t){var e=this,a=this;this.$refs[t].validate(function(t){if(!t)return!1;a.saveLoading=!0;var o={id:a.id,name:a.editForm.name,dateTime:a.editForm.dateTime,totalNumber:a.editForm.totalNumber,totalPrice:a.editForm.totalPrice,remark:a.editForm.remark,logisticsNo:a.editForm.logisticsNo,customerId:a.editForm.customerId,type:a.editForm.type,logisticsId:a.editForm.logisticsId.toString()};Object(i.Ic)(o).then(function(t){e.$message({type:"success",message:"操作成功!",duration:300,onClose:function(){sessionStorage.setItem("destroyId",t.data.id),a.id=t.data.id,a.param2.pid=t.data.id,a.requestClientInfo(),a.getAjaxList(2),a.saveLoading=!1,a.typeBool=!0}})})})},getAjaxSupplier:function(){var t=this;Object(i.td)(t.param).then(function(e){var a=e.data.items;a&&a.length>0?t.customerList=a:t.customerList=[]})},getAjaxProduct:function(){var t=this;Object(i.Md)(t.param).then(function(e){if(200==e.status){var a=e.data.items;a&&a.length>0?t.productList=a:t.productList=[]}})},getAjaxGroup:function(){var t=this;Object(i.hd)().then(function(e){if(200==e.status){var a=e.data;a&&a.length>0?t.groupList=a:t.groupList=[]}})}},beforeMount:function(){var t=sessionStorage.getItem("destroyId");t&&(this.id=t,this.param2.pid=t,this.typeBool=!0,this.requestClientInfo(),this.getAjaxList(2)),this.getAjaxProduct(),this.getdatatime(),this.getAjaxSupplier(),this.getAjaxGroup()}},r=(a("iG0b"),a("KHd+")),l=Object(r.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/destroy"}}},[t._v("报损单管理")]),t._v(" "),a("el-breadcrumb-item",[t._v("详情")])],1),t._v(" "),a("div",{staticClass:"contentBody"},[a("el-form",{ref:"editForm",staticClass:"demo-ruleForm",attrs:{model:t.editForm,rules:t.rules,"label-width":"100px"}},[a("el-form-item",{staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:function(e){return t.goBack()}}},[t._v("返回")])],1),t._v(" "),a("div",{staticStyle:{display:"flex"}},[a("el-form-item",{attrs:{label:"报损单名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:15,disabled:""},model:{value:t.editForm.name,callback:function(e){t.$set(t.editForm,"name",e)},expression:"editForm.name"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"316px"},attrs:{label:"报损单日期",prop:"dateTime"}},[a("el-date-picker",{attrs:{disabled:"",type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:t.editForm.dateTime,callback:function(e){t.$set(t.editForm,"dateTime",e)},expression:"editForm.dateTime"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"316px"},attrs:{label:"总量","label-width":"80px"}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:200,disabled:""},model:{value:t.editForm.totalNumber,callback:function(e){t.$set(t.editForm,"totalNumber",e)},expression:"editForm.totalNumber"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{disabled:"",type:"textarea",placeholder:"请输入",maxlength:200},model:{value:t.editForm.remark,callback:function(e){t.$set(t.editForm,"remark",e)},expression:"editForm.remark"}})],1)],1),t._v(" "),t.isShow?a("div",{staticClass:"contentBody"},[a("span",{staticStyle:{display:"block","margin-bottom":"15px"}},[t._v("驳回原因")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.contentData,border:""}},[a("el-table-column",{attrs:{align:"center","header-align":"center",type:"index",label:"序号",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"comment",label:"原因"}}),t._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"createUser",label:"驳回人"}}),t._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"createTime",label:"时间"}})],1)],1):t._e(),t._v(" "),t.id?a("div",{staticClass:"contentBody"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{align:"center","header-align":"center",type:"index",label:"序号",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"serialNo",label:"编号"}}),t._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"name",label:"名称"}}),t._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"standard",label:"单位"}}),t._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"number",label:"数量",width:"140"}})],1),t._v(" "),a("el-dialog",{staticStyle:{width:"60%",left:"35%"},attrs:{title:t.dialogTitle,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dialogForm",attrs:{model:t.dialogForm,rules:t.rules}},[a("el-form-item",{attrs:{label:"商品类型","label-width":t.formLabelWidth,prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.dialogForm.type,callback:function(e){t.$set(t.dialogForm,"type",e)},expression:"dialogForm.type"}},[a("el-option",{attrs:{label:"打包",value:"1"}},[t._v("打包")]),t._v(" "),a("el-option",{attrs:{label:"原材料",value:"2"}},[t._v("原材料")])],1)],1),t._v(" "),2==t.dialogForm.type?a("el-form-item",{attrs:{label:"原料名称","label-width":t.formLabelWidth,prop:"productInfoId"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.changeProduct},model:{value:t.dialogForm.productInfoId,callback:function(e){t.$set(t.dialogForm,"productInfoId",e)},expression:"dialogForm.productInfoId"}},t._l(t.productList,function(t){return a("el-option",{attrs:{label:t.name,value:t.id}})}),1)],1):t._e(),t._v(" "),1==t.dialogForm.type?a("el-form-item",{attrs:{label:"打包名称","label-width":t.formLabelWidth,prop:"productInfoId"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.changeGroup},model:{value:t.dialogForm.productInfoId,callback:function(e){t.$set(t.dialogForm,"productInfoId",e)},expression:"dialogForm.productInfoId"}},t._l(t.groupList,function(t){return a("el-option",{attrs:{label:t.name,value:t.id}})}),1)],1):t._e(),t._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"单位","label-width":t.formLabelWidth,prop:"standard"}},[a("el-input",{attrs:{autocomplete:"off",disabled:""},model:{value:t.dialogForm.standard,callback:function(e){t.$set(t.dialogForm,"standard",e)},expression:"dialogForm.standard"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"数量","label-width":t.formLabelWidth,prop:"number"}},[a("el-input-number",{attrs:{size:"medium",min:0,max:999999999,step:1},model:{value:t.dialogForm.number,callback:function(e){t.$set(t.dialogForm,"number",e)},expression:"dialogForm.number"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":t.formLabelWidth,prop:"remark"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.dialogForm.remark,callback:function(e){t.$set(t.dialogForm,"remark",e)},expression:"dialogForm.remark"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.saveLoading},on:{click:function(e){return t.dialogFormAdd("dialogForm")}}},[t._v("确 定")])],1)],1)],1):t._e()],1)],1)},[],!1,null,"c39cbc52",null);l.options.__file="detailDestroy.vue";e.default=l.exports},iG0b:function(t,e,a){"use strict";var i=a("0sPz");a.n(i).a}}]);