(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{"3aZV":function(e,t,a){"use strict";var r=a("aOUI");a.n(r).a},EFjf:function(e,t,a){"use strict";a.r(t);var r=a("TsPW"),i={name:"edit-user-manage",data:function(){return{tableData:null,typeBool:!1,formLabelWidth:"80px",dialogFormVisible:!1,dialogTitle:"新增入库明细",dialogForm:{standard:"",number:"",price:"",id:"",productInfoId:""},id:"",saveLoading:!1,editForm:{name:"",dateTime:"",totalNumber:"",totalPrice:"",remark:"",outStockOrderIds:[],customerId:sessionStorage.getItem("customerId"),type:"1"},disabled:!0,rules:{name:[{required:!0,message:"请输入入库单名称",trigger:"blur"},{min:1,max:15,message:"长度在 1 到 15 个字",trigger:"blur"}],number:[{required:!0,message:"请输入",trigger:"blur"},{min:1,max:15,message:"长度在 1 到 15 个字",trigger:"blur"}],price:[{required:!0,message:"请输入",trigger:"blur"},{min:1,max:15,message:"长度在 1 到 15 个字",trigger:"blur"}],standard:[{required:!0,message:"请输入",trigger:"blur"},{min:1,max:15,message:"长度在 1 到 15 个字",trigger:"blur"}],dateTime:[{required:!0,message:"请选择入库日期",trigger:"blur"}],outStockOrderIds:[{required:!0,message:"请选择门店订单",trigger:"blur"}]},headers:{sessionId:sessionStorage.getItem("sessionId")},outStockOrderList:[],param:{pageSize:-1},param2:{pid:""},param3:{pageSize:-1,status:1,customerId:sessionStorage.getItem("customerId")},productList:[]}},methods:{getdatatime:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,r=a>9?a:"0"+a,i=e.getDate(),o=i>9?i:"0"+i;this.editForm.dateTime=t+"-"+r+"-"+o},changeProduct:function(e){var t;t=this.productList.find(function(t){return t.id===e}),this.dialogForm.standard=t.standard},handleClickDetail:function(e,t,a){var i=this;"delete"==a?i.$confirm("真的删除该行数据么, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={id:t.id};Object(r.V)(e).then(function(e){200==e.status?i.$message({type:"success",message:"删除成功!",duration:300,onClose:function(){i.getAjaxList(1)}}):i.$message({type:"error",message:e.msg})})}).catch(function(){i.$message({type:"info",message:"已取消删除"})}):"add"==a?i.addOrg("add",t):"edit"==a&&i.addOrg("edit",t)},addOrg:function(e,t){this.dialogFormVisible=!0,"add"==e?(this.dialogForm.standard="",this.dialogForm.number="",this.dialogForm.id="",this.dialogForm.price=0,this.dialogForm.productInfoId=""):(this.dialogForm.standard=t.standard,this.dialogForm.id=t.id,this.dialogForm.number=t.number,this.dialogForm.price=t.price,this.dialogForm.productInfoId=t.productInfoId)},dialogFormAdd:function(e){var t,a=this;t={id:this.dialogForm.id,standard:this.dialogForm.standard,number:this.dialogForm.number,price:this.dialogForm.price,productInfoId:this.dialogForm.productInfoId,inStockOrderId:a.id},this.$refs[e].validate(function(e){if(!e)return!1;a.saveLoading=!0,Object(r.jd)(t).then(function(e){200==e.status?a.$message({type:"success",message:"操作成功!",duration:300,onClose:function(){a.saveLoading=!1,a.dialogFormVisible=!1,a.getAjaxList(1)}}):(a.saveLoading=!1,a.$message({type:"error",message:e.msg}))})})},getAjaxList:function(e){var t=this;Object(r.Gb)(t.param2).then(function(a){t.tableData=[];var r=a.data;if(r&&r.length>0){t.tableData=r;for(var i=0,o=0,l=0;l<t.tableData.length;l++)i+=t.tableData[l].price*t.tableData[l].number,o+=t.tableData[l].number;t.editForm.totalPrice=i,t.editForm.totalNumber=o,1==e&&t.submitForm("editForm")}else t.tableData=[]})},requestClientInfo:function(){var e=this,t=this;Object(r.Ud)({id:this.id}).then(function(a){if(200==a.status){var r=a.data;r&&(t.editForm.name=r.name,t.editForm.dateTime=r.dateTime,t.editForm.totalNumber=r.totalNumber,t.editForm.totalPrice=r.totalPrice,t.editForm.remark=r.remark,t.editForm.type=r.type+"",t.editForm.outStockOrderIds=r.outStockOrderIds.split(","))}else e.$message({message:"请求异常",type:"error"})})},goBack:function(){this.$router.push({path:"/shopInStoreManage"})},submitForm:function(e){var t=this,a=this;this.$refs[e].validate(function(e){if(!e)return!1;a.saveLoading=!0;var i={id:a.id,name:a.editForm.name,dateTime:a.editForm.dateTime,totalNumber:a.editForm.totalNumber,totalPrice:a.editForm.totalPrice,remark:a.editForm.remark,type:a.editForm.type,customerId:a.editForm.customerId,outStockOrderIds:2==a.editForm.type?"":a.editForm.outStockOrderIds.toString()};Object(r.kd)(i).then(function(e){t.$message({type:"success",message:"操作成功!",duration:300,onClose:function(){sessionStorage.setItem("inId",e.data.id),a.id=e.data.id,a.param2.pid=e.data.id,a.requestClientInfo(),a.getAjaxList(2),a.saveLoading=!1,a.typeBool=!0}})})})},getAjaxProduct:function(){var e=this;Object(r.Md)(e.param).then(function(t){if(200==t.status){var a=t.data.items;a&&a.length>0?e.productList=a:e.productList=[]}})},getAjaxPList:function(){var e=this;Object(r.Xb)(e.param3).then(function(t){var a=t.data.items;a&&a.length>0?e.outStockOrderList=a:e.outStockOrderList=[]})}},beforeMount:function(){var e=sessionStorage.getItem("inId");e&&(this.id=e,this.param2.pid=e,this.typeBool=!0,this.requestClientInfo(),this.getAjaxList(2)),this.getAjaxPList(),this.getAjaxProduct(),this.getdatatime()}},o=(a("3aZV"),a("KHd+")),l=Object(o.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/shopInStoreManage"}}},[e._v("门店入库管理")]),e._v(" "),a("el-breadcrumb-item",[e._v(e._s(""==e.id?"新增":"编辑"))])],1),e._v(" "),a("div",{staticClass:"contentBody"},[a("el-form",{ref:"editForm",staticClass:"demo-ruleForm",attrs:{model:e.editForm,rules:e.rules,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"入库单名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:15,disabled:""},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}}),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"入库日期",prop:"dateTime"}},[a("el-date-picker",{attrs:{disabled:"",type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.editForm.dateTime,callback:function(t){e.$set(e.editForm,"dateTime",t)},expression:"editForm.dateTime"}})],1)],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{width:"316px"},attrs:{label:"总量"}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:200,disabled:""},model:{value:e.editForm.totalNumber,callback:function(t){e.$set(e.editForm,"totalNumber",t)},expression:"editForm.totalNumber"}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"中央厨房出库单",prop:"outStockOrderIds"}},[a("el-select",{staticClass:"self-select-width",attrs:{placeholder:"请选择",disabled:e.typeBool,multiple:""},model:{value:e.editForm.outStockOrderIds,callback:function(t){e.$set(e.editForm,"outStockOrderIds",t)},expression:"editForm.outStockOrderIds"}},e._l(e.outStockOrderList,function(e){return a("el-option",{attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入",maxlength:200},model:{value:e.editForm.remark,callback:function(t){e.$set(e.editForm,"remark",t)},expression:"editForm.remark"}})],1),e._v(" "),a("el-form-item",[a("el-button",{on:{click:function(t){return e.goBack()}}},[e._v("返回")])],1)],1),e._v(" "),e.id?a("div",{staticClass:"contentBody"},[2==e.editForm.type?a("el-form",{staticClass:"demo-form-inline",attrs:{"label-width":"60px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{"label-width":"0"}},[a("el-button",{attrs:{icon:"el-icon-plus",circle:""},on:{click:function(t){return e.handleClickDetail("","","add")}}})],1)],1)],1)],1):e._e(),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{align:"center","header-align":"center",type:"index",label:"序号",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"serialNo",label:"编号"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"name",label:"名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"standard",label:"单位"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"number",label:"数量",width:"140"}}),e._v(" "),2==e.editForm.type?a("el-table-column",{attrs:{align:"center","header-align":"center",label:"操作",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleClickDetail(t.$index,t.row,"edit")}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleClickDetail(t.$index,t.row,"delete")}}},[e._v("删除")])]}}],null,!1,2993806499)}):e._e()],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dialogForm",attrs:{model:e.dialogForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"名称","label-width":e.formLabelWidth,prop:"productInfoId"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeProduct},model:{value:e.dialogForm.productInfoId,callback:function(t){e.$set(e.dialogForm,"productInfoId",t)},expression:"dialogForm.productInfoId"}},e._l(e.productList,function(e){return a("el-option",{attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"单位","label-width":e.formLabelWidth,prop:"standard"}},[a("el-input",{attrs:{autocomplete:"off",disabled:""},model:{value:e.dialogForm.standard,callback:function(t){e.$set(e.dialogForm,"standard",t)},expression:"dialogForm.standard"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"数量","label-width":e.formLabelWidth,prop:"number"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.dialogForm.number,callback:function(t){e.$set(e.dialogForm,"number",t)},expression:"dialogForm.number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"单价","label-width":e.formLabelWidth,prop:"price"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.dialogForm.price,callback:function(t){e.$set(e.dialogForm,"price",t)},expression:"dialogForm.price"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:function(t){return e.dialogFormAdd("dialogForm")}}},[e._v("确 定")])],1)],1)],1):e._e()],1)],1)},[],!1,null,"3cf2e686",null);l.options.__file="detailShopInStock.vue";t.default=l.exports},aOUI:function(e,t,a){}}]);