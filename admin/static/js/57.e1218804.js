(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{CsMb:function(e,t,a){"use strict";a.r(t);var r=a("YEIV"),i=a.n(r),l=a("TsPW"),o={name:"edit-out-stock-order",data:function(){var e,t=sessionStorage.getItem("customerId");return e={activeName:"1",tableListData:null,typeBool:!1,classify:1,tableData:null,logisticsInfo:!1,formLabelWidth:"80px",dialogFormVisible:!1,dialogTitle:"新增退货单明细",dialogForm:{standard:"",number:"",price:"",id:"",name:"",serialNo:"",productInfoId:"",goodsId:"",type:"",customerId:t},id:"",saveLoading:!1,editForm:{name:"",dateTime:"",totalNumber:"",totalPrice:"",remark:"",logisticsNo:"",logisticsId:"",customerId:t,company:"",type:"",plateNumber:[]},rules:{name:[{required:!0,message:"请输入退货单名称",trigger:"blur"}],dateTime:[{required:!0,message:"请选退货日期",trigger:"blur"}],productInfoId:[{required:!0,message:"请选择名称",trigger:"blur"}]},headers:{sessionId:sessionStorage.getItem("sessionId")},purchaseList:[],LogisticsList:[],customerList:[],param:{pageSize:-1},param4:{content:"",pageSize:-1,isDelete:1},param5:{pageSize:-1,customerId:t,type:"2"},searchForm:{name:"",serialNo:""}},i()(e,"tableData",null),i()(e,"param",{name:"",pageNo:1,type:1,pageSize:10,serialNo:"",isDelete:1}),i()(e,"totalNum",0),i()(e,"searchForm2",{name:"",serialNo:""}),i()(e,"tableData2",null),i()(e,"param2",{name:"",pageNo:1,type:2,pageSize:10,serialNo:"",isDelete:1}),i()(e,"totalNum2",0),i()(e,"param3",{pid:""}),e},methods:{handleClick:function(e,t){"1"==e.name?(this.dialogForm.type=1,this.getAjaxList()):"2"==e.name&&(this.dialogForm.type=2,this.getAjaxList2())},changeType:function(){this.dialogForm.productInfoId=""},getdatatime:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,r=a>9?a:"0"+a,i=e.getDate(),l=i>9?i:"0"+i;this.editForm.dateTime=t+"-"+r+"-"+l},handleClickDetail:function(e,t,a){var r=this;"delete"==a?r.$confirm("真的删除该行数据么, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={id:t.id};Object(l.Z)(e).then(function(e){200==e.status?r.$message({type:"success",message:"删除成功!",duration:300,onClose:function(){r.getAjaxList(1),r.getDetailAjaxList()}}):r.$message({type:"error",message:e.msg})})}).catch(function(){r.$message({type:"info",message:"已取消删除"})}):"add"==a&&(r.dialogFormVisible=!0,r.getAjaxList())},handleClickAdd:function(e,t){if(this.tableData[e].number>0){var a,r=this;a={id:this.dialogForm.id,standard:t.standard,number:this.tableData[e].number,price:t.price,name:t.name,serialNo:t.serialNo,productInfoId:t.productInfoId,goodsId:t.id,type:t.type,storeReturnId:r.id,customerId:this.dialogForm.customerId},Object(l.ud)(a).then(function(e){200==e.status?r.$message({type:"success",message:"操作成功!",duration:300,onClose:function(){r.saveLoading=!1,r.getDetailAjaxList(1)}}):(r.saveLoading=!1,r.$message({type:"error",message:e.msg}))})}else this.$message({type:"error",message:"请选择数量！"})},handleClickAdd2:function(e,t){if(this.tableData2[e].number>0){var a,r=this;a={id:this.dialogForm.id,standard:t.standard,number:t.number,price:t.price,name:t.name,serialNo:t.serialNo,productInfoId:t.productInfoId,goodsId:t.id,type:t.type,storeReturnId:r.id,customerId:this.dialogForm.customerId},Object(l.ud)(a).then(function(e){200==e.status?r.$message({type:"success",message:"操作成功!",duration:300,onClose:function(){r.saveLoading=!1,r.getDetailAjaxList(1)}}):(r.saveLoading=!1,r.$message({type:"error",message:e.msg}))})}else this.$message({type:"error",message:"请选择数量！"})},getDetailAjaxList:function(e){var t=this;Object(l.Mb)(t.param2).then(function(a){t.tableListData=[];var r=a.data;r&&r.length>0?(t.tableListData=r,1==e&&t.requestClientInfo()):t.tableListData=[]})},requestClientInfo:function(){var e=this,t=this;Object(l.Ce)({id:this.id}).then(function(a){if(e.logisticsInfo=!0,200==a.status){var r=a.data;r&&(t.editForm.name=r.name,t.editForm.dateTime=r.dateTime,t.editForm.totalNumber=r.totalNumber,t.editForm.totalPrice=r.totalPrice,t.editForm.remark=r.remark,t.editForm.logisticsId=r.logisticsId,t.editForm.logisticsNo=r.logisticsNo),null!=r.logistics&&(t.editForm.plateNumber=r.logistics.plateNumber,t.editForm.contact=r.logistics.contact,t.editForm.phone=r.logistics.phone,t.editForm.company=r.logistics.company)}else e.$message({message:"请求异常",type:"error"})})},goBack:function(){this.$router.push({path:"/storereturn"})},submitForm:function(e){var t=this,a=this;this.$refs[e].validate(function(e){if(!e)return!1;a.saveLoading=!0;var r={id:a.id,name:a.editForm.name,dateTime:a.editForm.dateTime,totalNumber:a.editForm.totalNumber,totalPrice:a.editForm.totalPrice,remark:a.editForm.remark,logisticsNo:a.editForm.logisticsNo,customerId:a.editForm.customerId,logisticsId:a.editForm.logisticsId.toString()};Object(l.td)(r).then(function(e){t.$message({type:"success",message:"操作成功!",duration:300,onClose:function(){sessionStorage.setItem("storeReturnId",e.data.id),a.id=e.data.id,a.param2.pid=e.data.id,a.requestClientInfo(),a.getAjaxList(2),a.saveLoading=!1,a.typeBool=!0}})})})},onSearch:function(){this.param.pageNo=1,this.param.name=this.searchForm.name,this.param.serialNo=this.searchForm.serialNo,this.getAjaxList()},handleCurrentChange:function(e){this.param.pageNo=e,this.getAjaxList()},getAjaxList:function(){var e=this;Object(l.Gd)(e.param).then(function(t){if(200==t.status){var a=t.data.items;a&&a.length>0?(e.tableData=a,e.totalNum=parseInt(t.data.totalNum)):(e.tableData=[],e.totalNum=0)}})},onSearch2:function(){this.param2.pageNo=1,this.param2.name=this.searchForm2.name,this.param2.serialNo=this.searchForm2.serialNo,this.getAjaxList2()},handleCurrentChange2:function(e){this.param2.pageNo=e,this.getAjaxList2()},getAjaxList2:function(){var e=this;Object(l.Gd)(e.param2).then(function(t){if(200==t.status){var a=t.data.items;a&&a.length>0?(e.tableData2=a,e.totalNum2=parseInt(t.data.totalNum)):(e.tableData2=[],e.totalNum2=0)}})},getAjaxLogisticsList:function(){var e=this;Object(l.Kd)(e.param4).then(function(t){var a=t.data.items;a&&a.length>0?e.LogisticsList=a:e.LogisticsList=[]})}},beforeMount:function(){var e=sessionStorage.getItem("storeReturnId");e&&(this.id=e,this.param2.pid=e,this.typeBool=!0,this.requestClientInfo(),this.getAjaxList(2)),this.getAjaxLogisticsList(),this.getdatatime(),this.getDetailAjaxList()}},n=(a("x8Ay"),a("KHd+")),s=Object(n.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/storereturn"}}},[e._v("门店退货管理")]),e._v(" "),a("el-breadcrumb-item",[e._v(e._s(""==e.id?"新增":"编辑"))])],1),e._v(" "),a("div",{staticClass:"contentBody"},[a("el-form",{ref:"editForm",staticClass:"demo-ruleForm",attrs:{model:e.editForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"退货单名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:15},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{width:"316px"},attrs:{label:"总量"}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:200,disabled:""},model:{value:e.editForm.totalNumber,callback:function(t){e.$set(e.editForm,"totalNumber",t)},expression:"editForm.totalNumber"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{width:"316px"},attrs:{label:"物流电话"}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:200,disabled:""},model:{value:e.editForm.phone,callback:function(t){e.$set(e.editForm,"phone",t)},expression:"editForm.phone"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{width:"316px"},attrs:{label:" 物流车牌号"}},[a("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.editForm.logisticsId,callback:function(t){e.$set(e.editForm,"logisticsId",t)},expression:"editForm.logisticsId"}},e._l(e.LogisticsList,function(e){return a("el-option",{attrs:{label:e.plateNumber,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{width:"316px"},attrs:{label:"物流单号"}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:200},model:{value:e.editForm.logisticsNo,callback:function(t){e.$set(e.editForm,"logisticsNo",t)},expression:"editForm.logisticsNo"}})],1)],1)],1),e._v(" "),e.logisticsInfo?a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{width:"316px"},attrs:{label:"物流公司名称"}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:200,disabled:""},model:{value:e.editForm.company,callback:function(t){e.$set(e.editForm,"company",t)},expression:"editForm.company"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{width:"316px"},attrs:{label:"物流联系人"}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:200,disabled:""},model:{value:e.editForm.contact,callback:function(t){e.$set(e.editForm,"contact",t)},expression:"editForm.contact"}})],1)],1)],1):e._e(),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{width:"316px"},attrs:{label:"退货日期",prop:"dateTime"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.editForm.dateTime,callback:function(t){e.$set(e.editForm,"dateTime",t)},expression:"editForm.dateTime"}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入",maxlength:200},model:{value:e.editForm.remark,callback:function(t){e.$set(e.editForm,"remark",t)},expression:"editForm.remark"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:function(t){return e.submitForm("editForm")}}},[e._v("提交")]),e._v(" "),a("el-button",{on:{click:function(t){return e.goBack()}}},[e._v("返回")])],1)],1),e._v(" "),e.id?a("div",{staticClass:"contentBody"},[a("el-form",{staticClass:"demo-form-inline",attrs:{"label-width":"60px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{"label-width":"0"}},[a("el-button",{attrs:{icon:"el-icon-plus",circle:""},on:{click:function(t){return e.handleClickDetail("","","add")}}})],1)],1)],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableListData,border:""}},[a("el-table-column",{attrs:{align:"center","header-align":"center",type:"index",label:"序号",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"serialNo",label:"编号"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"name",label:"名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"standard",label:"单位"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"number",label:"数量",width:"140"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleClickDetail(t.$index,t.row,"delete")}}},[e._v("删除")])]}}],null,!1,2088583025)})],1)],1):e._e()],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogFormVisible,width:"80%",top:"5vh"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"门店商品",name:"1"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"编号"}},[a("el-input",{attrs:{maxlength:200,autocomplete:"off",placeholder:"编号",clearable:""},model:{value:e.searchForm.serialNo,callback:function(t){e.$set(e.searchForm,"serialNo",t)},expression:"searchForm.serialNo "}})],1),e._v(" "),a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{attrs:{maxlength:200,autocomplete:"off",placeholder:"名称",clearable:""},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"0"}},[a("el-button",{attrs:{icon:"el-icon-search",circle:"","native-type":"submit"},nativeOn:{click:function(t){return t.preventDefault(),e.onSearch(t)}}})],1)],1),e._v(" "),a("el-table",{attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{align:"center","header-align":"center",type:"index",label:"行号",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"serialNo",label:"编号",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"name",label:"名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"stock",label:"库存量",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"number",label:"数量",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input-number",{staticStyle:{width:"130px"},attrs:{min:0,max:e.tableData[t.$index].stock},model:{value:e.tableData[t.$index].number,callback:function(a){e.$set(e.tableData[t.$index],"number",a)},expression:"tableData[scope.$index].number"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"standard",label:"单位",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.handleClickAdd(t.$index,t.row)}}},[e._v("添加")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"","current-page":e.param.pageNo,"page-size":e.param.pageSize,layout:"total,prev, pager, next",total:e.totalNum},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.param,"pageNo",t)},"update:current-page":function(t){return e.$set(e.param,"pageNo",t)}}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"固定资产",name:"2"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm2,"label-width":"80px"}},[a("el-form-item",{staticStyle:{"font-family":"MicrosoftYaHeiLight","font-weight":"bold",color:"rgba(102,102,102,1)"},attrs:{label:"编号"}},[a("el-input",{attrs:{maxlength:200,autocomplete:"off",placeholder:"编号",clearable:""},model:{value:e.searchForm2.serialNo,callback:function(t){e.$set(e.searchForm2,"serialNo",t)},expression:"searchForm2.serialNo "}})],1),e._v(" "),a("el-form-item",{staticStyle:{"font-family":"MicrosoftYaHeiLight","font-weight":"bold",color:"rgba(102,102,102,1)"},attrs:{label:"名称"}},[a("el-input",{attrs:{maxlength:200,autocomplete:"off",placeholder:"名称",clearable:""},model:{value:e.searchForm2.name,callback:function(t){e.$set(e.searchForm2,"name",t)},expression:"searchForm2.name"}})],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"0"}},[a("el-button",{attrs:{icon:"el-icon-search",circle:"","native-type":"submit"},nativeOn:{click:function(t){return t.preventDefault(),e.onSearch2(t)}}})],1)],1),e._v(" "),a("el-table",{attrs:{data:e.tableData2,border:""}},[a("el-table-column",{attrs:{align:"center","header-align":"center",type:"index",label:"行号",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"serialNo",label:"编号",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"name",label:"名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"stock",label:"库存量",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"number",label:"数量",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input-number",{staticStyle:{width:"130px"},attrs:{min:0,max:e.tableData2[t.$index].stock},model:{value:e.tableData2[t.$index].number,callback:function(a){e.$set(e.tableData2[t.$index],"number",a)},expression:"tableData2[scope.$index].number"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"standard",label:"单位",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.handleClickAdd2(t.$index,t.row)}}},[e._v("添加")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"","current-page":e.param2.pageNo,"page-size":e.param2.pageSize,layout:"total,prev, pager, next",total:e.totalNum2},on:{"current-change":e.handleCurrentChange2,"update:currentPage":function(t){return e.$set(e.param2,"pageNo",t)},"update:current-page":function(t){return e.$set(e.param2,"pageNo",t)}}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("关闭")])],1)],1)],1)},[],!1,null,"532fbcc4",null);s.options.__file="editStoreReturn.vue";t.default=s.exports},ICsY:function(e,t,a){},"RU/L":function(e,t,a){a("Rqdy");var r=a("WEpk").Object;e.exports=function(e,t,a){return r.defineProperty(e,t,a)}},Rqdy:function(e,t,a){var r=a("Y7ZC");r(r.S+r.F*!a("jmDH"),"Object",{defineProperty:a("2faE").f})},SEkw:function(e,t,a){e.exports={default:a("RU/L"),__esModule:!0}},YEIV:function(e,t,a){"use strict";t.__esModule=!0;var r=function(e){return e&&e.__esModule?e:{default:e}}(a("SEkw"));t.default=function(e,t,a){return t in e?(0,r.default)(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},x8Ay:function(e,t,a){"use strict";var r=a("ICsY");a.n(r).a}}]);