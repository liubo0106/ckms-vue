(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{"+StV":function(e,t,a){},GQeE:function(e,t,a){e.exports={default:a("iq4v"),__esModule:!0}},Mqbl:function(e,t,a){var r=a("JB68"),i=a("w6GO");a("zn7N")("keys",function(){return function(e){return i(r(e))}})},YjMG:function(e,t,a){"use strict";var r=a("+StV");a.n(r).a},eGQK:function(e,t,a){"use strict";a.r(t);var r=a("GQeE"),i=a.n(r),o=a("TsPW"),l={name:"edit-user-manage",data:function(){var e=sessionStorage.getItem("customerId");return"null"==e&&(e="-"),{searchForm:{name:""},flover:"",activeName2:"1",isManager:"",loading:!1,name:"",totalNum:0,formLabelWidth:"100px",dialogOrderVisible:!1,dialogTableVisibleData2:!1,doType:sessionStorage.getItem("doType"),param:{customerId:sessionStorage.getItem("customerId"),pageNo:1,pageSize:10,isSide:0,isDelete:1,name:"",categoryId:"",kind:"",status:1},orgTreeData:[],saveLoading:!1,editForm:{customerId:sessionStorage.getItem("customerId"),orderNo:"",deskId:"",deskNo:"",people:1,status:0,remark:"",customerName:sessionStorage.getItem("customerName")},goodsList:[],oldGoodsList:[],oldGoodsListData:[],oldrestaurantData:[],orderList:[],storeDeskOrdersList:[],orderDetailList:[],flavorList:[],dialogTableVisibleData:!1,tableData:null,tableDataDetail:[],dialogTreeTitle2:"点餐",dialogTreeFormVisible2:!1,dialogTasteVisible:!1,tasteList:[],tasteDetail:{},goodsId:"",showName:"",restaurantData:[],isTaste:!0,rules:{goodsId:[{required:!0,message:"请选择口味",trigger:"blur"}]},tableDataDetailFlover:[],activeName:"first",saveLoadingId:"",goodsLoading:!0,dialogTitle:"退菜",dialogFormVisible:!1,dialogForm:{type:"1",number:"",maxNumber:"",reason:"",customerId:e,orderId:"",orderDetailId:"",storeGoodsId:"",name:""},type:0,data:[{label:"菜品种类",children:[{kind:1,label:"炒锅涮锅"},{kind:2,label:"烧烤"},{kind:3,label:"凉菜"},{kind:0,label:"其它"}]}],defaultProps:{children:"children",label:"label"}}},methods:{handleClickData:function(e,t){1==e.name&&(this.type=0),2==e.name&&(this.type=1)},getTreeAjaxList:function(){var e=this;Object(o.Od)({}).then(function(t){if(200==t.status){var a=t.data;a&&(a&&a.length>0?e.orgTreeData=a:e.orgTreeData=[])}else e.$message({type:"error",message:"系统异常!"})})},indexMethod:function(e){return(this.param.pageNo-1)*this.param.pageSize+e+1},handleNodeClick:function(e){console.log(e),this.param.kind=e.kind,this.param.categoryId=e.id,this.getAjaxGoodsList()},diners:function(e){},handClickDetail:function(e,t){var a=this;this.dialogTableVisibleData=!0;var r=t.id;Object(o.Dc)({setMealId:r}).then(function(e){a.tableDataDetail=[];var t=e.data.items;t&&t.length>0?a.tableDataDetail=t:a.tableDataDetail=[]})},getRestaurant:function(){var e=this;this.param.isSale=1,Object(o.wc)(this.param).then(function(t){200==t.status&&(e.restaurantData=t.data.items)})},onSearch:function(e){var t=this;if(0==e)this.param.name=this.searchForm.name,this.getAjaxGoodsList();else if(this.searchForm.name=this.searchForm.name.toLowerCase(),""==this.searchForm.name&&this.oldrestaurantData.length>0)this.restaurantData=this.oldrestaurantData;else{0==this.oldrestaurantData.length&&(this.oldrestaurantData=this.restaurantData);var a;a=this.oldrestaurantData.filter(function(e){return i()(e).some(function(a){return String(e[a]).toLowerCase().indexOf(t.searchForm.name)>-1})}),this.restaurantData=a}},handleFreeClick:function(e,t,a){var r=this,i=this;"isFree"==a?this.$confirm("是否免费?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={id:t.id,isFree:0};Object(o.sd)(e).then(function(e){r.$message({type:"success",message:"操作成功!",duration:300,onClose:function(){i.param.pageNo=1,i.getStoreDeskOrderList()}})})}).catch(function(){r.$message({type:"info",message:"已取消"})}):"isClose"==a?this.$confirm("是否取消免费?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={id:t.id,isFree:1};Object(o.sd)(e).then(function(e){r.$message({type:"success",message:"操作成功!",duration:300,onClose:function(){i.param.pageNo=1,i.getStoreDeskOrderList()}})})}).catch(function(){r.$message({type:"info",message:"已取消"})}):"order"==a?(this.dialogTreeFormVisible2=!0,0==this.goodsList.length&&(this.getAjaxGoodsList(),this.getRestaurant(),this.getTreeAjaxList())):"delete"==a?this.$confirm("真的删除该行数据么, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.loading=!0;var e={id:t.id};Object(o.te)(e).then(function(e){r.$message({type:"success",message:"删除成功!",duration:300,onClose:function(){i.loading=!1,i.param.pageNo=1,i.getStoreDeskOrderList()}})})}).catch(function(){r.$message({type:"info",message:"已取消删除"})}):"retreat"==a&&(this.dialogForm.number=t.number,this.dialogForm.orderId=t.storeOrderId,this.dialogForm.orderDetailId=t.id,this.dialogForm.storeGoodsId=t.goodsId,this.dialogForm.name=t.name,this.dialogForm.maxNumber=t.number,this.dialogFormVisible=!0)},dialogFormAdd:function(e){var t,a=this;t={type:this.dialogForm.type,number:this.dialogForm.number,reason:this.dialogForm.reason,customerId:this.dialogForm.customerId,orderId:this.dialogForm.orderId,orderDetailId:this.dialogForm.orderDetailId,storeGoodsId:this.dialogForm.storeGoodsId,name:this.dialogForm.name},this.$refs[e].validate(function(e){e&&(a.saveLoading=!0,Object(o.ve)(t).then(function(e){200==e.status?a.$message({type:"success",message:"操作成功!",duration:300,onClose:function(){a.saveLoading=!1,a.dialogFormVisible=!1,a.getStoreDeskOrderList()}}):(a.saveLoading=!1,a.$message({type:"error",message:e.msg}))}))})},handleClick:function(e,t,a){var r=this;"delete"==a&&this.$confirm("真的删除该行数据么, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.loading=!0;for(var e=0;e<r.orderDetailList.length;e++)r.orderDetailList[e].productInfoId==t.productInfoId&&(r.orderDetailList.splice(e,1),r.loading=!1)}).catch(function(){r.$message({type:"info",message:"已取消删除"})})},getFlavorAjaxList:function(){var e=this;Object(o.Je)({type:"口味"}).then(function(t){var a=t.data;200==t.status?a&&a.length>0?e.flavorList=a:e.flavorList=[]:e.$message({message:"请求异常",duration:"2000",type:"error"})})},handleClickPrint:function(e){var t=this;t.saveLoadingId=e,Object(o.hc)({id:e}).then(function(e){200==e.status?t.saveLoadingId="":(t.saveLoadingId="",t.$message({message:"请求异常",duration:"2000",type:"error"}))})},handleClickEnsure:function(e){var t=this,a=this;a.saveLoadingId=e,this.$confirm("真的确认该订单么, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.loading=!0;var r={id:e,status:1};Object(o.ke)(r).then(function(e){t.$message({type:"success",message:"操作成功!",duration:300,onClose:function(){a.saveLoadingId="",a.getStoreDeskOrderList()}})})}).catch(function(){t.$message({type:"info",message:"已取消"})})},showDetailDialog:function(){this.dialogOrderVisible=!0},dialogClose:function(){this.dialogTableVisibleData2=!1},endData:function(){for(var e=0;e<this.tableDataDetailFlover.length;e++)if(void 0!=this.tableDataDetailFlover[e].goodsDetailList&&""==this.tableDataDetailFlover[e].flavor)return this.$message({type:"error",message:"请选择口味"}),!1;for(var t=0;t<this.tableDataDetailFlover.length;t++)this.tasteDetail.setMealDetailList.push(this.tableDataDetailFlover[t]);this.orderDetailList.push(this.tasteDetail),this.dialogTableVisibleData2=!1},handleClickTree:function(e,t,a){var r=this;if(2==a){if(this.tasteDetail={type:t.type,goodsId:t.id,name:t.name,number:t.number,price:t.price,productInfoId:t.productInfoId,remark:t.remark,kind:999,isDiscount:t.isDiscount,isFree:1,setMealDetailList:[]},0==this.tasteDetail.number)return this.$message({type:"error",message:"请选择添加数量！"}),!1;this.dialogTableVisibleData2=!0,Object(o.xc)({setMealId:t.id}).then(function(e){200==e.status&&(r.tableDataDetailFlover=e.data,r.tableDataDetailFlover.forEach(function(e){r.$set(e,"flavor","")})),console.log(r.tableDataDetailFlover)})}else if(this.goodsList[e].number>0){var i=this;Object(o.Fd)({parentId:t.id}).then(function(e){i.tasteList=[];var a=e.data.items;a&&a.length>0?(i.tasteList=a,r.tasteDetail={type:t.type,goodsId:t.id,name:t.name,number:t.number,price:t.price,remark:t.remark,productInfoId:t.productInfoId,kind:t.kind,isDiscount:t.isDiscount,isFree:1},r.dialogTasteVisible=!0):(i.tasteList=[],r.tasteDetail={type:t.type,goodsId:t.id,name:t.name,number:t.number,price:t.price,productInfoId:t.productInfoId,remark:t.remark,kind:t.kind,isDiscount:t.isDiscount,isFree:1},r.orderDetailList.push(r.tasteDetail),r.dialogTasteVisible=!1)})}else this.$message({type:"error",message:"请选择数量！"})},handleClickTaste:function(){this.showName?(this.tasteDetail.flavor=this.showName,this.tasteDetail.sideGoodsId=this.goodsId,this.orderDetailList.push(this.tasteDetail),this.goodsId="",this.showName="",this.dialogTasteVisible=!1):this.$message({type:"error",message:"请选择口味！"})},changeTaste:function(e){var t;t=this.tasteList.find(function(t){return t.goodsId===e}),this.showName=t.showName,this.goodsId=t.goodsId},getSummaries:function(e){var t=e.columns,a=e.data,r=[],i=[];return t.forEach(function(e,t){0!==t?5===t&&("totalPrice"==e.property&&(i=a.map(function(e){return Number(e.price*e.number)})),i.every(function(e){return isNaN(e)})?r[t]="0元":(r[t]=i.reduce(function(e,t){var a=Number(t);return isNaN(a)?e:e+t},0),r[t]+=" 元")):r[t]="合计"}),r},handleSizeChangeGoods:function(e){this.param.pageSize=e,this.getAjaxGoodsList()},handleCurrentChangeGoods:function(e){this.param.pageNo=e,this.getAjaxGoodsList()},getAjaxGoodsList:function(){var e=this;Object(o.Gd)(this.param).then(function(t){if(200==t.status){var a=t.data.items;a&&a.length>0&&(e.goodsList=a,e.oldGoodsListData=a,e.totalNum=parseInt(t.data.totalNum)),e.goodsLoading=!1}else e.$message({message:"请求异常",type:"error"})})},goBack:function(){this.$router.push({path:"/order"})},getStoreDeskOrderList:function(){var e=this;this.storeDeskOrdersList=[],this.activeName=[],Object(o.ne)({id:this.editForm.deskId}).then(function(t){if(e.loading=!1,200==t.status){var a=t.data.orders;a&&a.length>0&&(e.storeDeskOrdersList=a,e.storeDeskOrdersList.forEach(function(t){e.activeName.push(t.id)})),e.isManager=t.data.isManager}else e.$message({message:"请求异常",type:"error"})})},addDialogOrderForm:function(e){var t=this;this.orderDetailList.length>0?(this.saveLoading=!0,this.loading=!0,Object(o.se)(this.orderDetailList).then(function(e){if(200==e.status){var a=String(t.editForm.people).indexOf(".")+1;String(t.editForm.people).length;if(a>0)return t.$message({type:"error",message:"用餐人数请不要输入小数",duration:1e3}),t.saveLoading=!1,t.loading=!1,!1;var r={customerId:t.editForm.customerId,orderNo:"",deskId:t.editForm.deskId,deskNo:t.editForm.deskNo,people:t.editForm.people,remark:t.editForm.remark,customerName:t.editForm.customerName,status:1,detailList:t.orderDetailList};t.storeDeskOrdersList.length>0&&(r.orderNo=t.storeDeskOrdersList[0].orderNo),Object(o.rd)(r).then(function(e){200==e.status?(t.saveLoading=!1,t.loading=!1,t.doType="edit",sessionStorage.setItem("doType","edit"),t.dialogOrderVisible=!1,t.getStoreDeskOrderList(),t.getAjaxGoodsList(),t.orderDetailList=[]):t.$message({message:"请求异常",duration:"2000",type:"error"})})}else t.$message({type:"error",message:e.data}),t.saveLoading=!1,t.loading=!1})):this.$message({message:"请先添加订单!",duration:"2000",type:"error"})},addGreensFun:function(){var e=this,t=this,a=localStorage.getItem("oldDeskId"),r=localStorage.getItem("newDeskId"),i=localStorage.getItem("newDeskNo");t.editForm.deskId=r,t.editForm.deskNo=i,a&&Object(o.j)({id:a}).then(function(a){200==a.status?e.$message({type:"success",message:"转桌成功!",duration:300,onClose:function(){a.data&&(t.orderDetailList=a.data)}}):t.$message({type:"error",message:a.msg})}),localStorage.removeItem("oldDeskId"),localStorage.removeItem("newDeskId"),localStorage.removeItem("newDeskNo")}},beforeMount:function(){var e=sessionStorage.getItem("deskId"),t=sessionStorage.getItem("deskNo");e&&t&&(this.editForm.deskId=e,this.editForm.deskNo=t,"edit"==this.doType&&this.getStoreDeskOrderList()),null!=localStorage.getItem("oldDeskId")&&this.addGreensFun(),this.getFlavorAjaxList()}},n=(a("YjMG"),a("KHd+")),s=Object(n.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/order"}}},[e._v("顾客订单结算管理")]),e._v(" "),a("el-breadcrumb-item",[e._v(e._s("add"==e.doType?"新增":"编辑"))])],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"contentBody",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(241, 242, 247, 0.5)"}},[a("el-row",{staticStyle:{"margin-bottom":"20px","text-align":"right"}},[a("div",{staticStyle:{"font-size":"30px","margin-right":"50%"}},[e._v(e._s(e.editForm.deskNo)+"号桌")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleFreeClick("","","order")}}},[e._v("点餐")])],1),e._v(" "),a("el-form",{ref:"editForm",staticClass:"demo-ruleForm",attrs:{model:e.editForm,"label-width":"100px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderDetailList,border:"","show-summary":"","summary-method":e.getSummaries}},[a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"name",label:"名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"number",label:"数量",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"price",label:"单价",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"flavor",label:"口味",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"remark",label:"备注",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"totalPrice",label:"总价",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(e.orderDetailList[t.$index].number*e.orderDetailList[t.$index].price)+"\n                    ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{background:"#e16870",color:"rgba(255,255,255,1)","border-radius":"5px"},attrs:{icon:"el-icon-delete",size:"small"},on:{click:function(a){return e.handleClick(t.$index,t.row,"delete")}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"right"}},[a("el-row",{staticStyle:{"text-align":"right","margin-bottom":"2%","margin-top":"10px"}},[a("el-form-item",{attrs:{label:"备注:"}},[a("el-input",{model:{value:e.editForm.remark,callback:function(t){e.$set(e.editForm,"remark",t)},expression:"editForm.remark"}})],1)],1),e._v(" "),a("el-row",{staticStyle:{"text-align":"right"}},[e._v("\n                    用餐人数:  "),a("el-input-number",{attrs:{min:1},on:{change:e.diners},model:{value:e.editForm.people,callback:function(t){e.$set(e.editForm,"people",t)},expression:"editForm.people"}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.showDetailDialog("editForm")}}},[e._v("确认下单")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.goBack()}}},[e._v("返回")])],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogTreeTitle2,visible:e.dialogTreeFormVisible2,width:"80%",top:"5vh"},on:{"update:visible":function(t){e.dialogTreeFormVisible2=t}}},[a("el-container",[a("el-main",[0==e.type?a("el-form",{ref:"editForm",staticClass:"demo-ruleForm",attrs:{model:e.editForm,"label-width":"40px","label-position":"left"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"搜索"}},[a("el-input",{attrs:{maxlength:200,autocomplete:"off",placeholder:"名称",clearable:""},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{"label-width":"0"}},[a("el-button",{attrs:{icon:"el-icon-search",circle:"","native-type":"submit"},nativeOn:{click:function(t){return t.preventDefault(),e.onSearch(0)}}})],1)],1)],1)],1):a("el-form",{ref:"editForm",staticClass:"demo-ruleForm",attrs:{model:e.editForm,"label-width":"100px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"搜索"}},[a("el-input",{attrs:{maxlength:200,autocomplete:"off",placeholder:"名称",clearable:""},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{"label-width":"0"}},[a("el-button",{attrs:{icon:"el-icon-search",circle:"","native-type":"submit"},nativeOn:{click:function(t){return t.preventDefault(),e.onSearch(1)}}})],1)],1)],1)],1),e._v(" "),a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClickData},model:{value:e.activeName2,callback:function(t){e.activeName2=t},expression:"activeName2"}},[a("el-tab-pane",{attrs:{label:"单品",name:"1"}},[a("el-container",[a("el-aside",{staticStyle:{width:"150px"}},[a("el-tree",{attrs:{data:e.data,props:e.defaultProps,"default-expand-all":!0},on:{"node-click":e.handleNodeClick}}),e._v(" "),a("el-tree",{attrs:{"default-expand-all":"",data:e.orgTreeData,props:e.defaultProps},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var r=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(r.name))])])}}])})],1),e._v(" "),a("el-main",[a("el-form",{ref:"editForm",staticClass:"demo-ruleForm",attrs:{model:e.editForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"","label-width":"0px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.goodsLoading,expression:"goodsLoading"}],attrs:{data:e.goodsList,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"序号",type:"index",index:e.indexMethod,align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"名称",prop:"name",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"库存量",prop:"stock",align:"center","header-align":"center",width:"80px"}}),e._v(" "),a("el-table-column",{attrs:{label:"数量",prop:"number",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("el-form-item",{},[a("el-input-number",{staticStyle:{width:"130px"},attrs:{min:0,max:e.goodsList[t.$index].stock,disabled:0==t.row.isSale||0==t.row.stock},model:{value:e.goodsList[t.$index].number,callback:function(a){e.$set(e.goodsList[t.$index],"number",a)},expression:"goodsList[scope.$index].number"}})],1)}}])}),e._v(" "),a("el-table-column",{attrs:{label:"单价(元)",prop:"price",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("el-form-item",{},[a("el-input-number",{staticStyle:{width:"130px"},attrs:{min:0,disabled:""},model:{value:e.goodsList[t.$index].price,callback:function(a){e.$set(e.goodsList[t.$index],"price",a)},expression:"goodsList[scope.$index].price"}})],1)}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",prop:"stockName",align:"center","header-align":"center",width:"80px"}}),e._v(" "),a("el-table-column",{attrs:{label:"单品备注",prop:"remark",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("el-form-item",{},[a("el-input",{attrs:{disabled:0==t.row.isSale||0==t.row.stock},model:{value:e.goodsList[t.$index].remark,callback:function(a){e.$set(e.goodsList[t.$index],"remark",a)},expression:"goodsList[scope.$index].remark"}})],1)}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.handleClickTree(t.$index,t.row)}}},[e._v("添加")])]}}])})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-pagination",{attrs:{"current-page":e.param.pageNo,"page-sizes":[10,20,30,40],"page-size":e.param.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalNum},on:{"size-change":e.handleSizeChangeGoods,"current-change":e.handleCurrentChangeGoods}})],1)],1)],1)],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"套餐",name:"2"}},[a("el-form",{ref:"editForm",staticClass:"demo-ruleForm",attrs:{model:e.editForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"","label-width":"0px"}},[a("el-table",{attrs:{data:e.restaurantData,stripe:"",height:"400"}},[a("el-table-column",{attrs:{label:"名称",prop:"name",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"数量",prop:"number",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("el-form-item",{},[a("el-input-number",{staticStyle:{width:"130px"},attrs:{min:0},model:{value:e.restaurantData[t.$index].number,callback:function(a){e.$set(e.restaurantData[t.$index],"number",a)},expression:"restaurantData[scope.$index].number"}})],1)}}])}),e._v(" "),a("el-table-column",{attrs:{label:"单价(元)",prop:"price",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("el-form-item",{},[a("el-input-number",{staticStyle:{width:"130px"},attrs:{min:0,disabled:""},model:{value:e.restaurantData[t.$index].price,callback:function(a){e.$set(e.restaurantData[t.$index],"price",a)},expression:"restaurantData[scope.$index].price"}})],1)}}])}),e._v(" "),a("el-table-column",{attrs:{label:"套餐备注",prop:"remark",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("el-form-item",{},[a("el-input",{model:{value:e.restaurantData[t.$index].remark,callback:function(a){e.$set(e.restaurantData[t.$index],"remark",a)},expression:"restaurantData[scope.$index].remark"}})],1)}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",label:"操作",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.handleClickTree(t.$index,t.row,2)}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.handClickDetail(t.$index,t.row)}}},[e._v("详情")])]}}])})],1)],1)],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTreeFormVisible2=!1}}},[e._v("关闭")])],1)],1),e._v(" "),"edit"==e.doType?a("div",{staticClass:"contentBody"},[a("el-collapse",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.storeDeskOrdersList,function(t){return a("el-collapse-item",{attrs:{name:t.id}},[a("template",{slot:"title"},[1==t.status?a("el-button",{staticStyle:{"margin-right":"20px"},attrs:{type:"primary",loading:t.id==e.saveLoadingId,size:"small"},on:{click:function(a){return e.handleClickPrint(t.id)}}},[e._v("出票")]):e._e(),e._v(" "),0==t.status?a("el-button",{staticStyle:{"margin-right":"20px"},attrs:{type:"success",loading:t.id==e.saveLoadingId,size:"small"},on:{click:function(a){return e.handleClickEnsure(t.id)}}},[e._v("确认")]):e._e(),e._v("\n                    订单号："+e._s(t.orderNo)+"，用餐人数："+e._s(t.people)+"，状态："+e._s(t.statusName)+"，消费总额："+e._s(t.totalPrice)+"，备注："+e._s(t.remark)+"\n                ")],1),e._v(" "),a("el-table",{attrs:{data:t.detailList,"max-height":"400"}},[a("el-table-column",{attrs:{label:"名称",prop:"name",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"数量",prop:"number",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"单价",prop:"price",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"totalPrice",label:"总价",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                            "+e._s(t.row.number*t.row.price)+"\n                        ")]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"口味",prop:"flavor",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"单品备注",prop:"remark",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","header-align":"center",width:"240"},scopedSlots:e._u([{key:"default",fn:function(r){return[1==e.isManager&&1==t.status&&r.row.number>0?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleFreeClick(r.$index,r.row,"retreat")}}},[e._v("退菜")]):e._e(),e._v(" "),1==e.isManager&&0==t.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleFreeClick(r.$index,r.row,"delete")}}},[e._v("删除")]):e._e(),e._v(" "),1==r.row.isFree?a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(t){return e.handleFreeClick(r.$index,r.row,"isFree")}}},[e._v("赠送")]):e._e(),e._v(" "),0==r.row.isFree?a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleFreeClick(r.$index,r.row,"isClose")}}},[e._v("取消赠送")]):e._e()]}}],null,!0)})],1)],2)}),1)],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"提交订单",visible:e.dialogOrderVisible},on:{"update:visible":function(t){e.dialogOrderVisible=t}}},[a("el-table",{attrs:{data:e.orderDetailList,height:"400","show-summary":"","summary-method":e.getSummaries}},[a("el-table-column",{attrs:{label:"名称",prop:"name",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"数量",prop:"number",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    x"+e._s(e.orderDetailList[t.$index].number)+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"单价",prop:"price",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"口味",prop:"flavor",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"remark",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"totalPrice",label:"总价",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.orderDetailList[t.$index].number*e.orderDetailList[t.$index].price)+"\n                ")]}}])})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{round:""},on:{click:function(t){e.dialogOrderVisible=!1}}},[e._v("取     消")]),e._v(" "),a("el-button",{attrs:{type:"warning",round:"",loading:e.saveLoading},on:{click:e.addDialogOrderForm}},[e._v("提交订单")])],1)],1),e._v(" "),a("el-dialog",{staticStyle:{width:"800px",left:"25%"},attrs:{title:"添加口味",visible:e.dialogTasteVisible},on:{"update:visible":function(t){e.dialogTasteVisible=t}}},[a("el-form",{attrs:{rules:e.rules}},[a("el-form-item",{staticStyle:{width:"316px"},attrs:{label:"口味","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择",prop:"goodsId"},on:{change:e.changeTaste},model:{value:e.goodsId,callback:function(t){e.goodsId=t},expression:"goodsId"}},e._l(e.tasteList,function(e){return a("el-option",{attrs:{label:e.showName,value:e.goodsId}})}),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleClickTaste("","","taste")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogFormVisible,width:"35%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dialogForm",attrs:{model:e.dialogForm,"label-width":"100px",rules:e.rules}},[a("el-radio-group",{model:{value:e.dialogForm.type,callback:function(t){e.$set(e.dialogForm,"type",t)},expression:"dialogForm.type"}},[a("el-form-item",{attrs:{label:"类型"}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-radio",{attrs:{label:"1"}},[e._v("菜品问题")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("时间问题")])],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-radio",{attrs:{label:"3"}},[e._v("服务问题")]),e._v(" "),a("el-radio",{attrs:{label:"4"}},[e._v("其他")])],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"数量"}},[a("el-input-number",{attrs:{size:"medium",precision:2,min:0,max:e.dialogForm.maxNumber},model:{value:e.dialogForm.number,callback:function(t){e.$set(e.dialogForm,"number",t)},expression:"dialogForm.number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入",maxlength:200},model:{value:e.dialogForm.reason,callback:function(t){e.$set(e.dialogForm,"reason",t)},expression:"dialogForm.reason"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:function(t){return e.dialogFormAdd("dialogForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"套餐详情",visible:e.dialogTableVisibleData},on:{"update:visible":function(t){e.dialogTableVisibleData=t}}},[a("el-table",{attrs:{data:e.tableDataDetail}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"150",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"name",label:"菜品名称",width:"200",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"serialNo",label:"菜品编号",width:"200",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"price",label:"单价",width:"200",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"number",label:"数量",width:"100",align:"center","header-align":"center"}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"选择口味",visible:e.dialogTableVisibleData2},on:{"update:visible":function(t){e.dialogTableVisibleData2=t}}},[a("el-table",{attrs:{data:e.tableDataDetailFlover}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"150",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"菜品名称",prop:"name",width:"200",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"单价",width:"200",prop:"price",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"数量",width:"100",prop:"number",align:"center","header-align":"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"口味选择",width:"200",prop:"goodsDetailList",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{placeholder:"请选择口味"},model:{value:t.row.flavor,callback:function(a){e.$set(t.row,"flavor",a)},expression:"scope.row.flavor"}},e._l(t.row.goodsDetailList,function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})}),1)]}}])})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"20px","text-align":"right"}},[a("el-button",{attrs:{plain:""},on:{click:e.dialogClose}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.endData}},[e._v("确认")])],1)],1)],1)},[],!1,null,"11ac1178",null);s.options.__file="editOrder.vue";t.default=s.exports},iq4v:function(e,t,a){a("Mqbl"),e.exports=a("WEpk").Object.keys},zn7N:function(e,t,a){var r=a("Y7ZC"),i=a("WEpk"),o=a("KUxP");e.exports=function(e,t){var a=(i.Object||{})[e]||Object[e],l={};l[e]=t(a),r(r.S+r.F*o(function(){a(1)}),"Object",l)}}}]);