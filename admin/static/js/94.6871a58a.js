(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{"3QES":function(e,t,a){"use strict";var i=a("s9dT");a.n(i).a},"RU/L":function(e,t,a){a("Rqdy");var i=a("WEpk").Object;e.exports=function(e,t,a){return i.defineProperty(e,t,a)}},Rqdy:function(e,t,a){var i=a("Y7ZC");i(i.S+i.F*!a("jmDH"),"Object",{defineProperty:a("2faE").f})},SEkw:function(e,t,a){e.exports={default:a("RU/L"),__esModule:!0}},YEIV:function(e,t,a){"use strict";t.__esModule=!0;var i=function(e){return e&&e.__esModule?e:{default:e}}(a("SEkw"));t.default=function(e,t,a){return t in e?(0,i.default)(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},naf1:function(e,t,a){"use strict";a.r(t);var i=a("YEIV"),r=a.n(i),o=a("TsPW"),l={name:"edit-user-manage",data:function(){var e,t=sessionStorage.getItem("customerId"),a=sessionStorage.getItem("id");return e={kindList:[{name:"炒锅涮锅",value:1},{name:"烧烤",value:2},{name:"凉菜",value:3},{name:"其他",value:0}],oldProductInfoId:"",pathIds:sessionStorage.getItem("pathIds"),headers:{sessionId:sessionStorage.getItem("sessionId")},id:a,saveLoading:!1,formLabelWidth:"100px",searchForm:{name:""},dialogTasteVisible:!1,editForm:{customerId:t,num:0,type:"1",productInfoId:"",price:0,isSale:"1",isSide:"0",isDiscount:1,remark:"",name:"",serialNo:"",standard:"",categoryId:"",kind:"",id:0,totalPrice:0,stock:0},type:0,param:{pageNo:1,pageSize:15,isLook:"1"},param3:{pid:"0"},categoryList:[],rules:{num:[{required:!0,message:"请输入排序号",trigger:"blur"}],name:[{required:!0,message:"请输入套餐名称",trigger:"blur"}],kind:[{required:!0,message:"请选择菜品种类",trigger:"blur"}]},imageUrl:"",upLoadAction:o.Oe,avatarBosKey:"",commodityName:"名称",dialogTreeTitle:"新增门店商品",dialogTreeFormVisible:!1,activeName:"1",searchTreeForm:{name:"",serialNo:""},tableTreeData:null,paramTree:{name:"",pageNo:1,pageSize:10,deptId:"",checkChild:"all",serialNo:"",packCategoryId:""},totalTreeNum:0,orgTreeData:[],defaultProps:{children:"children",label:"name"},searchTreeForm2:{name:"",serialNo:""},tableTreeData2:null,paramTree2:{name:"",pageNo:1,pageSize:10,deptId:"",checkChild:"all",serialNo:"",categoryId:"",isLook:"1"},totalTreeNum2:0,orgTreeData2:[],searchTreeForm3:{name:"",serialNo:""},tableTreeData3:null,totalTreeNum3:0,orgTreeData3:[],dialogTreeFormVisible2:!1,dialogTreeTitle2:"新增菜品明细",tableData:[]},r()(e,"tableTreeData3",null),r()(e,"totalTreeNum3",0),r()(e,"paramTree3",{pageNo:1,pageSize:10,name:"",isSale:"",isSide:"",customerId:t,isDelete:1}),r()(e,"tableTreeData4",{num:0,showName:""}),r()(e,"dialogTitle",""),r()(e,"dialogFormVisible",!1),r()(e,"dialogForm",{parentId:"",goodsId:"",type:"",productInfoId:"",serialNo:"",name:"",standard:"",num:"",showName:"",number:"",id:""}),e},computed:{costPrice:function(){if(this.tableData.length>0){for(var e=0,t=0;t<this.tableData.length;t++)if(null!=this.tableData[t].price){var a=this.tableData[t];e+=a.price*a.number}return e}}},methods:{indexMethod:function(e){return(this.paramTree3.pageNo-1)*this.paramTree3.pageSize+e+1},handleRowClick:function(){this.getTreeAjaxPage(),this.getTreeAjaxList(),this.dialogTreeFormVisible=!0},changeTaste:function(e){var t;t=this.tasteList.find(function(t){return t.goodsId===e}),this.showName=t.showName,this.goodsId=t.goodsId,this.addParam.showName=t.showName},handleSizeChange:function(e){var t=this;t.paramTree3.pageSize=e,Object(o.Gd)(t.paramTree3).then(function(e){t.tableTreeData3=[];var a=e.data.items;a&&a.length>0?(t.tableTreeData3=a,t.totalTreeNum3=parseInt(e.data.totalNum)):(t.tableTreeData3=[],t.totalTreeNum3=0)})},handleCurrentChange:function(e){this.paramTree3.pageNo=e,this.getAjaxDosingList()},onSearchTree:function(){this.paramTree.pageNo=1,this.paramTree.serialNo=this.searchTreeForm.serialNo,this.paramTree.name=this.searchTreeForm.name,this.getTreeAjaxPage()},handleCurrentChangeTree:function(e){this.paramTree.pageNo=e,this.getTreeAjaxPage()},onSearch:function(){this.paramTree3.name=this.searchForm.name,this.getAjaxDosingList()},handleClickDetail:function(e,t,a){var i=this;"delete"==a?i.$confirm("真的删除该行数据么, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={id:t.id};Object(o.uc)(e).then(function(e){200==e.status?i.$message({type:"success",message:"删除成功!",duration:300,onClose:function(){i.getAjaxList()}}):i.$message({type:"error",message:e.msg})})}).catch(function(){i.$message({type:"info",message:"已取消删除"})}):"add"==a?(this.getAjaxDosingList(),this.dialogTreeFormVisible2=!0):"edit"==a&&i.addOrg("edit",t)},getAjaxDosingList:function(e){var t=this;Object(o.Gd)(t.paramTree3).then(function(e){var a=e.data.items;a&&a.length>0?(t.tableTreeData3=a,t.totalTreeNum3=parseInt(e.data.totalNum)):(t.tableTreeData3=[],t.totalTreeNum3=0)})},handleClickTreeAdd3:function(e,t){var a,i=this;return 0==(a={setMealId:i.id,goodsId:t.id,type:t.type,productInfoId:t.productInfoId,serialNo:t.serialNo,name:t.name,price:t.price,standard:t.standard,showName:this.tableTreeData3[e].name,number:this.tableTreeData3[e].number}).number?(this.$message({type:"error",message:"添加数量不能为0",duration:1e3}),!1):a.number>t.stock?(this.$message({type:"error",message:"添加数量不能大于库存",duration:1e3}),!1):void Object(o.Bc)(a).then(function(e){200==e.status?i.$message({type:"success",message:"操作成功!",duration:1e3,onClose:function(){i.saveLoading=!1,i.getAjaxList()}}):(i.saveLoading=!1,i.$message({type:"error",message:e.msg}))})},handleClickTaste:function(){},getAjaxList:function(){var e=this;Object(o.Dc)({setMealId:e.id}).then(function(t){e.tableData=[];var a=t.data.items;a&&a.length>0?e.tableData=a:e.tableData=[]})},changeCategory:function(e){this.categoryList.find(function(t){return t.id===e})},getAjaxCategory:function(){var e=this;Object(o.Zb)(e.param3).then(function(t){if(200==t.status){var a=t.data;a&&a.length>0?e.categoryList=a:e.categoryList=[]}})},requestGoodsInfo:function(){var e=this,t=this;this.type=sessionStorage.getItem("type"),Object(o.yc)({id:this.id}).then(function(a){if(200==a.status){var i=a.data;i&&(t.editForm.name=i.name,t.editForm.num=i.num,t.editForm.type=i.type+"",t.editForm.productInfoId=i.productInfoId,t.editForm.serialNo=i.serialNo,t.editForm.standard=i.standard,t.editForm.price=i.price,t.editForm.kind=i.kind,t.imageUrl=i.pictureUrl,t.editForm.isSale=i.isSale+"",t.editForm.isSide=i.isSide+"",t.editForm.isDiscount=i.isDiscount,t.oldProductInfoId=i.productInfoId,t.editForm.categoryId=i.categoryId,t.editForm.id=1)}else e.$message({message:"请求异常",type:"error"})})},addOrg:function(e,t){this.dialogFormVisible=!0,"add"==e||(this.disabled=!this.disabled,this.dialogTitle="编辑配料明细",this.dialogForm.parentId=t.parentId,this.dialogForm.goodsId=t.goodsId,this.dialogForm.type=t.type,this.dialogForm.productInfoId=t.productInfoId,this.dialogForm.serialNo=t.serialNo,this.dialogForm.name=t.name,this.dialogForm.standard=t.standard,this.dialogForm.num=t.num,this.dialogForm.showName=t.showName,this.dialogForm.number=t.number,this.dialogForm.id=t.id,this.dialogForm.price=t.price)},dialogFormAdd:function(e){var t,a=this;t={goodsId:a.dialogForm.goodsId,type:a.dialogForm.type,productInfoId:a.dialogForm.productInfoId,serialNo:a.dialogForm.serialNo,name:a.dialogForm.name,standard:a.dialogForm.standard,num:a.dialogForm.num,showName:this.dialogForm.showName,setMealId:this.dialogForm.parentId,number:a.dialogForm.number,id:a.dialogForm.id,price:a.dialogForm.price},this.$refs[e].validate(function(e){if(!e)return!1;a.saveLoading=!0,Object(o.Bc)(t).then(function(e){200==e.status?a.$message({type:"success",message:"操作成功!",duration:300,onClose:function(){a.saveLoading=!1,a.dialogFormVisible=!1,a.getAjaxList()}}):(a.saveLoading=!1,a.$message({type:"error",message:e.msg}))})})},goBack:function(){this.$router.push({path:"/restaurant"})},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG或PNG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},handleAvatarSuccess:function(e,t){var a=e.data;this.avatarBosKey=a.key,this.avatarBosKey?this.imageUrl=a.thumbnailUrl:this.$message.error("上传失败!")},submitForm:function(e){var t=this,a=this;this.$refs[e].validate(function(e){if(!e)return!1;a.saveLoading=!0;var i={id:a.id,num:a.editForm.num,type:a.editForm.type,productInfoId:a.editForm.productInfoId,price:a.editForm.price,isSale:a.editForm.isSale,isSide:a.editForm.isSide,isDiscount:a.editForm.isDiscount,remark:a.editForm.remark,name:a.editForm.name,serialNo:a.editForm.serialNo,standard:a.editForm.standard,picture:a.avatarBosKey,customerId:a.editForm.customerId,categoryId:a.editForm.categoryId,kind:a.editForm.kind,stock:a.editForm.stock};Object(o.Cc)(i).then(function(e){200==e.status?t.$message({type:"success",message:"操作成功!",duration:300,onClose:function(){a.id=e.data.id,a.requestGoodsInfo(),a.saveLoading=!1}}):t.$message({type:"info",message:e.msg})})})}},beforeMount:function(){this.getAjaxCategory(),this.id&&(this.requestGoodsInfo(),this.getAjaxList())}},n=(a("3QES"),a("KHd+")),s=Object(n.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/restaurant"}}},[e._v("门店套餐管理")]),e._v(" "),1==e.type?a("el-breadcrumb-item",[e._v("详情")]):a("el-breadcrumb-item",[e._v(e._s(""==e.id?"新增":"编辑"))])],1),e._v(" "),a("div",{staticClass:"contentBody"},[a("el-form",{ref:"editForm",staticClass:"demo-ruleForm",attrs:{model:e.editForm,rules:e.rules,"label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"排序号",prop:"num"}},[a("el-input-number",{staticStyle:{width:"216px"},attrs:{min:0,max:999999999},model:{value:e.editForm.num,callback:function(t){e.$set(e.editForm,"num",e._n(t))},expression:"editForm.num"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{width:"316px"},attrs:{label:"菜品分类","label-width":e.formLabelWidth,prop:"categoryId"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeCategory},model:{value:e.editForm.categoryId,callback:function(t){e.$set(e.editForm,"categoryId",t)},expression:"editForm.categoryId"}},e._l(e.categoryList,function(e){return a("el-option",{attrs:{label:e.name,value:e.id}})}),1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{width:"316px"},attrs:{label:"套餐名称",prop:"name","label-width":e.formLabelWidth}},[a("el-input",{staticStyle:{width:"216px"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{width:"316px"},attrs:{label:"菜品种类",prop:"kind","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editForm.kind,callback:function(t){e.$set(e.editForm,"kind",t)},expression:"editForm.kind"}},e._l(e.kindList,function(e){return a("el-option",{attrs:{label:e.name,value:e.value}})}),1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"是否上架"}},[[a("el-radio",{attrs:{label:"1"},model:{value:e.editForm.isSale,callback:function(t){e.$set(e.editForm,"isSale",t)},expression:"editForm.isSale"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:"0"},model:{value:e.editForm.isSale,callback:function(t){e.$set(e.editForm,"isSale",t)},expression:"editForm.isSale"}},[e._v("否")])]],2)],1),e._v(" "),1==e.editForm.id?a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"成本价"}},[[a("el-input",{staticStyle:{width:"216px"},attrs:{autocomplete:"off",disabled:""},model:{value:e.costPrice,callback:function(t){e.costPrice=t},expression:"costPrice"}})]],2)],1):e._e()],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"是否打折"}},[[a("el-radio",{attrs:{label:0},model:{value:e.editForm.isDiscount,callback:function(t){e.$set(e.editForm,"isDiscount",t)},expression:"editForm.isDiscount"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:1},model:{value:e.editForm.isDiscount,callback:function(t){e.$set(e.editForm,"isDiscount",t)},expression:"editForm.isDiscount"}},[e._v("否")])]],2)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"出售价格"}},[a("el-input-number",{staticStyle:{width:"216px"},attrs:{min:0,max:999999999},model:{value:e.editForm.price,callback:function(t){e.$set(e.editForm,"price",t)},expression:"editForm.price"}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"照片",prop:"avatarBosKey"}},[[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.upLoadAction,headers:e.headers,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),a("div",{staticClass:"el-upload__tip"},[e._v("只能上传jpg/png文件，且不超过2M")])]],2),e._v(" "),1!=e.type?a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:function(t){return e.submitForm("editForm")}}},[e._v("提交")]),e._v(" "),a("el-button",{on:{click:function(t){return e.goBack()}}},[e._v("返回")])],1):e._e()],1),e._v(" "),0==e.editForm.isSide&&e.id?a("div",{staticClass:"contentBody"},[1!=e.type?a("el-form",{staticClass:"demo-form-inline",attrs:{"label-width":"60px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{"label-width":"0"}},[a("el-button",{attrs:{icon:"el-icon-plus",circle:""},on:{click:function(t){return e.handleClickDetail("","","add")}}})],1)],1)],1)],1):e._e(),e._v(" "),a("el-table",{attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{align:"center","header-align":"center",type:"index",label:"序号",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"showName",label:"菜品名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"serialNo",label:"菜品编号"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"price",label:"单价",width:"140"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"number",label:"数量",width:"180"}}),e._v(" "),1!=e.type?a("el-table-column",{attrs:{align:"center","header-align":"center",label:"操作",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleClickDetail(t.$index,t.row,"edit")}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleClickDetail(t.$index,t.row,"delete")}}},[e._v("删除")])]}}],null,!1,2993806499)}):e._e()],1)],1):e._e()],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogTreeTitle2,visible:e.dialogTreeFormVisible2,width:"80%",top:"5vh"},on:{"update:visible":function(t){e.dialogTreeFormVisible2=t}}},[a("el-container",[a("el-main",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm,"label-width":"80px","label-position":"left"}},[a("el-row",{attrs:{gutter:13}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"商品名称"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{maxlength:240,autocomplete:"off",placeholder:"请输入",clearable:""},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-form-item",{attrs:{"label-width":"0"}},[a("el-button",{attrs:{icon:"el-icon-search",circle:"","native-type":"submit"},nativeOn:{click:function(t){return t.preventDefault(),e.onSearch(t)}}})],1)],1)],1)],1),e._v(" "),a("el-table",{attrs:{data:e.tableTreeData3,border:""}},[a("el-table-column",{attrs:{align:"center","header-align":"center",type:"index",index:e.indexMethod,label:"行号",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"name",label:"菜品名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"kind",label:"菜品种类",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.kind?a("span",[e._v("其他")]):e._e(),e._v(" "),1==t.row.kind?a("span",[e._v("炒锅涮锅")]):e._e(),e._v(" "),2==t.row.kind?a("span",[e._v("烧烤")]):e._e(),e._v(" "),3==t.row.kind?a("span",[e._v("凉菜")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"price",label:"单价"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"stock",label:"库存"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"safeStock",label:"数量",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input-number",{staticStyle:{width:"130px"},attrs:{min:0},model:{value:e.tableTreeData3[t.$index].number,callback:function(a){e.$set(e.tableTreeData3[t.$index],"number",a)},expression:"tableTreeData3[scope.$index].number"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.handleClickTreeAdd3(t.$index,t.row)}}},[e._v("添加")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.paramTree3.pageNo,"page-sizes":[10,20,30,40],"page-size":e.paramTree3.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalTreeNum3},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTreeFormVisible2=!1}}},[e._v("关闭")])],1)],1),e._v(" "),a("el-dialog",{staticStyle:{width:"800px",left:"25%"},attrs:{title:e.dialogTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dialogForm",attrs:{model:e.dialogForm,rules:e.rules}},[a("el-form-item",{staticStyle:{width:"316px"},attrs:{label:"商品名称","label-width":e.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入",disabled:""},model:{value:e.dialogForm.name,callback:function(t){e.$set(e.dialogForm,"name",t)},expression:"dialogForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"数量","label-width":e.formLabelWidth}},[a("el-input-number",{staticStyle:{width:"216px"},attrs:{min:0,max:999999999},model:{value:e.dialogForm.number,callback:function(t){e.$set(e.dialogForm,"number",t)},expression:"dialogForm.number"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:function(t){return e.dialogFormAdd("dialogForm")}}},[e._v("确 定")])],1)],1)],1)},[],!1,null,"73bfd6b0",null);s.options.__file="editInRestaurant.vue";t.default=s.exports},s9dT:function(e,t,a){}}]);